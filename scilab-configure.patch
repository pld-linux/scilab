--- scilab-2.6/configure.in	Tue Aug 21 05:05:17 2001
+++ scilab-2.6/configure.in.patch	Tue Aug 21 05:34:52 2001
@@ -472,13 +472,13 @@
     MAKEFILE_TARGET=Makefile.linux
    ;;
 # Linux ELF: all standard distributions
-  *-pc-linux-gnu)
+  i*86-*-linux-gnu)
     LIEEELIB=
     AC_CHECK_LIB(ieee,main,
       [LIEEELIB=-lieee])
     GCC=yes
     CC=cc
-    CC_OPTIONS='-O -Dlinux -fwritable-strings -DNARROWPROTO'
+    CC_OPTIONS="$CFLAGS -Dlinux -fwritable-strings -DNARROWPROTO"
     CC_LDFLAGS=$LIEEELIB
     # find Fortran compiler
     # g77 already asked and found: good
@@ -508,7 +508,7 @@
         fi
       fi
     fi
-    FC_OPTIONS=-O
+    FC_OPTIONS=$CFLAGS
     FC_OPTIONS_O0=
     FC_LDFLAGS="$LIEEELIB -ldl -rdynamic"
     LD=ld
@@ -524,7 +524,7 @@
     MALLOC=malloc.o
     GCC=yes
     CC=cc
-    CC_OPTIONS='-O -mieee-with-inexact -Dlinux -fwritable-strings'
+    CC_OPTIONS="$CFLAGS -mieee-with-inexact -Dlinux -fwritable-strings"
     CC_LDFLAGS='-ldl -rdynamic -mieee-with-inexact'
     CC_PICFLAGS=-fPIC
     # find Fortran compiler
@@ -555,7 +555,7 @@
         fi
       fi
     fi
-    FC_OPTIONS='-O -mieee-with-inexact'
+    FC_OPTIONS="$CFLAGS -mieee-with-inexact"
     FC_OPTIONS_O0='-mieee-with-inexact'
     FC_LDFLAGS='-ldl -rdynamic -mieee-with-inexact'
     LD=ld
@@ -573,7 +573,7 @@
       [LIEEELIB=-lieee])
     GCC=yes
     CC=cc
-    CC_OPTIONS='-O -D_GNU_SOURCE -Dlinux -fwritable-strings'
+    CC_OPTIONS="$CFLAGS -D_GNU_SOURCE -Dlinux -fwritable-strings"
     CC_LDFLAGS=$LIEEELIB
     CC_PICFLAGS=-fPIC
     # find Fortran compiler
@@ -1115,11 +1115,16 @@
 #####################
 
 AC_MSG_CHECKING([for use of sharpsign in CPP])
-AC_TRY_COMPILE([#define C2F(name) name##_],
-  [C2F(toto)()],  
+saved_flags=$CFLAGS
+CFLAGS="-o conftest. $CFLAGS"
+AC_TRY_COMPILE([#define C2F(name) name ## _
+C2F(toto)()
+{}
+],[],  
   AC_MSG_RESULT(yes)
   AC_DEFINE(USE_SHARP_SIGN),
   AC_MSG_RESULT(no))
+CFLAGS=$saved_flags
 
 ##############################################################
 ## test for functions in standard C library and C math library
@@ -1151,6 +1156,8 @@
 fi
 if test "$TERMCAPLIB" != no; then
   AC_DEFINE(HAVE_TERMCAP)
+  CC_OPTIONS="$CC_OPTIONS -I/usr/include/ncurses"
+  FC_OPTIONS="$FC_OPTIONS -I/usr/include/ncurses"
 else
   TERMCAPLIB=
 fi
